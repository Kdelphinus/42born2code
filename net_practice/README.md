# Net_Practice

### 기본 단어

- 컴퓨터 네트워크: 두 대 이상의 연결된 컴퓨터
- 패킷: 네트워크를 통해 전송되는 데이터의 작은 조각
  - 큰 데이터가 큰 비중의 대역폭(최대 전송 속도로 정보를 전송할 수 있는 단위 시간당 전송량)을 사용하지 못하도록 일정 크기로 조절하는 역할
  - 데이터가 잘게 쪼개지기에 파일별로 번호를 붙여 다 받은 뒤, 정렬
- LAN(Local Area Network): 근거리 통신망, 사무실 같이 지리적으로 제한된 공간
- WAN(Wide Area Network): 광역 통신망, 인터넷 서비스 제공자(ISP, KT나 SK브로드밴드 등)가 제공하는 서비스를 통해 구축된 네트워크

### OSI 모델

- 통신할 때, 송신 측 데이터는 7계층부터 아래 계층으로 순차적으로 이동한다.
- 반대로 수신 측 데이터는 아래 계층부터 순차적으로 올라온다.
- 각 계층은 전달되는 동안 다른 계층의 영향을 받지 않는다.

| 계층  | 이름                         | 설명                                       |
|:----|:---------------------------|:-----------------------------------------|
| 7계층 | 응용 계층(Application Layer)   | 이메일과 파일 전송, 웹 사이트 조회 등 애플리케이션에 대한 서비스 제공 |
| 6계층 | 표현 계층(Presentation Layer)  | 문자 코드, 압축, 암호화 등의 데이터를 변환                |
| 5계층 | 세션 계층(Session Layer)       | 세션 체결, 통신 방식을 결정                         |
| 4계층 | 전송 계층(Transport Layer)     | 신뢰할 수 있는 통신 구현                           |
| 3계층 | 네트워크 계층(Network Layer)     | 다른 네트워크와 통신하기 위한 경로 설정 및 논리 주소 결정        |
| 2계층 | 데이터 링크 계층(Data Link Layer) | 네트워크 기기 간의 데이터 전송 및 물리 주소를 결정            |
| 1계층 | 물리 계층(Physical Layer)      | 시스템 간의 물리적인 연결과 전기 신호를 변환 및 제어           |

### TCP/IP 모델

| 계층  | 이름                         | 설명                                |
|:----|:---------------------------|:----------------------------------|
| 4계층 | 응용 계층(Application Layer)   | OSI 모델의 응용, 표현, 세션 계층             |
| 3계층 | 전송 계층(Transport Layer)     | OSI 모델의 전송 계층                     |
| 2계층 | 인터넷 계층(Network Layer)      | 다른 네트워크와 통신하기 위한 경로 설정 및 논리 주소 결정 |
| 1계층 | 네트워크 접속 계층(Physical Layer) | 시스템 간의 물리적인 연결과 전기 신호를 변환 및 제어    |

### 캡슐화와 역캡슐화

- 헤더: 전송 시 필요한 정보들, 데이터 앞부분에 붙는다.
- 캡슐화: 헤더들을 붙이는 과정
  - 응용 계층의 데이터에 전송 계층 헤더, 네트워크 계층 헤더, 데이터 링크 계층 헤더가 차례대로 붙고 데이터 링크 계층에서 헤더와 함께 트레일러가 뒤에 붙는다.
  - 트레일러: 마지막에 추가하는 정보
- 역캡슐화: 수신한 데이터를 해석하는 과정
  - 캡슐화의 역순으로 헤더를 분리하며 정보 확인

### 전기 신호
- 송수신을 위해 전기 신호로 변환이 필요
- 송신 측은 비트를 전기 신호로 변환, 수신 측은 전기 신호를 비트열로 변환
- 물리 계층에서 랜 카드가 변환 작업을 수행

### 전송 매체
- 데이터가 흐르는 물리적 선로, 유선과 무선
- 트위스트 페어 케이블: 말 그대로 구리 선을 꼬아서 만든 케이블
  - UTP 케이블: 실드 없음, 노이즈 있음, 비용 저렴
  - STP 케이블: 실드 있음, 노이즈 적음, 비용 비쌈
- 랜 케이블: 트위스트 페어 케이블과 동일
  - 다이렉트 케이블: 구리 선 여덟 개를 같은 순서로 연결
    - 컴퓨터와 스위치를 연결할 때 사용
  - 크로스 케이블: 연결된 커넥트가 다름
    - 컴퓨터 간에 직접 랜 케이블로 연결할 때
    - 송수신 채널이 두 컴퓨터가 같으면 충돌이 일어나기에 꼬아놓음
  - 두 케이블 모두 1,2,3,6번 케이블만 사용

### 리피터와 허브
- 리피터: 전기 신호를 정형(일그러진 전기 신호를 복원)하고 증폭하는 네트워크 중계 장비
  - 요즘은 다른 기기가 리피터의 동작을 대신하기에 쓰지 않음
- 허브: 포트를 여러 개 가지고 있어서 컴퓨터 여러 대와 통신 가능
  - 리피터와 마찬가지로 전기 신호를 정형하고 증폭하는 기능 수행
  - 또한 여러 대를 서로 연결하는 장치
  - 특정 한 대에 데이터를 보내도 연결된 모든 컴퓨터에 데이터로 간다. 그래서 더미 허브(dummy hub)라고 하기도 한다.
  - 이를 대처하기 위해 스위치라는 장비가 나옴

### 데이터 링크 계층의 역할과 이더넷
- 데이터 링크 계층은 네트워크 장비 간에 신호를 주고받는 규칙을 정하는 계층
- 그 중 가장 많이 사용되는 규칙이 바로 이더넷(Ethernet)
- 하나의 컴퓨터에만 전송해도 연결된 모든 컴퓨터로 전송되는 허브의 단점을 보완하기 위해 데이터에 목적지를 추가하여 목적지 외에 컴퓨터가 못 보도록 처리
- 또한 허브는 여러 컴퓨터에서 데이터를 전송하면 충돌 위험이 있음 -> 이를 이더넷은 보완하여 충돌이 안 생기게 함
  - 이더넷은 데이터 보내는 시점을 늦추는 것으로 충돌을 해결
  - 이 방법을 CSMA/CD 라고 함
    - CS: 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 아닌지 확인
    - MA: 케이블에 데이터가 흐르고 있지 않다면 데이터를 보내도 좋다
    - CD: 충돌이 발생하고 있는지를 확인한다
    - 현재는 효율 문제로 거의 사용하지 않음
    - 대체제로 스위치 사용

### MAC 주소
- 랜 카드는 MAC 주소라는 물리 주소가 할당됨
  - 이 주소는 겹치지 않는 고유 주소
  - 앞쪽 24비트(랜 카드를 만든 제조사 번호) + 뒤쪽 24비트(제조사가 붙인 일련번호)
- 데이터 링크 계층(TCP/IP에선 네트워크 계층)에서 이더넷 헤더와 트레일러 헤더를 붙임
  - 이더넷 헤더(14바이트): 목적지의 MAC 주소(6바이트) + 출발지의 MAC 주소(6바이트) + 유형(2바이트)
  - 유형: 이더넷으로 전송되는 상위 계층 프로토콜의 종류, 즉 프로토콜을 식별하는 16진수 번호가 들어감
  - 트레일러 헤더(FCS(Frame Check Sequence)): 데이터 전송 도중에 오류가 발생했는지 확인
  - 프레임: 이더넷 헤더와 트레일러가 추가된 데이터
  - 목적지가 아닌 컴퓨터는 데이터 파기

### 스위치(Switch)
- 레이어 2 스위치 또는 스위칭 허브라고도 불림
- 데이터 링크 계층에서 동작
- 스위치 내부에는 `MAC 주소 테이블` 이 있음
  - 스위치의 포트 번호와 해당 포트에 연결되어 있는 컴퓨터의 MAC 주소가 등록되어 있는 데이터베이스
  - MAC 주소 학습 기능: 프레임이 전송되면 MAC 주소 테이블을 확인하고 출발지 MAC 주소가 등록되어 있지 않다면 MAC 주소를 포트와 함께 등록
  - 플러딩(flooding, 홍수): 아직 출발지 MAC 주소만 등록되어있기에 연결된 모든 컴퓨터에 데이터를 전송되는 프레임들
  - MAC 주소 필터링: 만약 목적지 MAC 주소가 등록되어 있다면 목적지에만 데이터를 전송

### 전이중 통신과 반이중 통신
- 전이중 통신 방식: 데이터의 송수신을 동시에 통신하는 방식
  - 데이터를 동시에 전송해도 충돌이 일어나지 않음
  - 컴퓨터 두 대를 직접 랜 케이블로 연결(이때 크로스 케이블을 이용해야 함)
  - 스위치는 충돌 위험이 없기에 전이중 통신 방식 사용
- 반이중 통신 방식: 회선 하나로 송신과 수신을 번갈아가면서 통신하는 방식
  - 데이터를 동시에 전송하면 충돌함
  - 하지만 허브 내부에서는 송수신이 나뉘어져 있지 않기에 충돌이 일어날 수 있음
  - 그렇기에 번갈아가며 이용하는 반이중 통신 방식을 사용

### ARP
- ARP(주소 변환 프로토콜)은 IP 주소를 MAC 주소로 변환하는데 사용
- APR 캐시는 가장 최근에 변환한 IP 대 하드웨어 주소를 보관하고 있는 램의 한 영역
- APR 요청: IP 주소를 대치할 수 있는 물리 주소인 MAC 주소를 찾아내기 위해 보내는 브로트캐스트 패킷 요청
- APR 응답: APR 요청에 대한 응답으로 요청한 IP 주소에 대한 물리 주소인 MAC 주소가 실려 있다.

### 충돌 도메인
- 충돌이 발생할 때, 그 영향이 미치는 범위
- 허브는 연결되어 있는 컴퓨터 전체가 하나의 충돌 도메인
- 스위치는 하나의 컴퓨터만 하나의 충돌 도메인이 된다.
- 그렇기에 충돌 도메인 관점에서도 스위치를 사용하면 좋다.

### 이더넷 규격
- 규격의 형식은 `{통신속도} {전송 방식} {케이블 종류}` 으로 구성된다.
- 예를 들어 10BASE-T는 다음과 같은 정보를 가진다.
  - 10: 10Mbps 단위의 통신 속도
  - BASE: BASEBAND라는 전송 방식 사용
  - T: 케이블 종류
- -뒤는 케이블의 길이나 종류를 나타냄, -T는 UTF케이블을 의미
- 만약 -이 없는 케이블이면 동축케이블로 100미터 단위로 표시
- 2018년 기준 랜 포트는 1000BASE-T가 일반적이고 10GBASE-T가 증가하는 추세

### 네트워크 계층의 역할
- 네트워크 계층은 서로 다른 네트워크에 있는 목적지로 데이터를 전송하기 위해 필요
- 수많은 네트워크가 연결된 환경에선 데이터 링크 계층의 기능만으론 한계가 있다.
- 이를 위해 네트워크 간의 통신을 가능하게 하는 라우터를 사용한다.
  - 해당 목적지까지 어떤 경로로 가는 것이 좋은지 알려줌
  - 여기선 네트워크를 식별하는 주소가 필요하며 이 주소를 IP 주소라고 한다.
- IP 주소: 어떤 네트워크의 어떤 컴퓨터인지를 구분할 수 있는 주소
  - 또한 어떤 경로로 보낼지도 결정해야 한다.
- 라우팅 테이블에서 경로 정보를 등록하고 관리한다.

### IP
- Internet protocol
- 네트워크 계층에서는 캡슐화할 때, IP 헤더를 붙인다.
- IP 헤더의 구성 요소는 다음 순서와 같다.
  - version
  - 헤더 길이
  - 서비스 유형
  - 전체 패킷 길이
  - ID
  - 조각 상태
  - 조각의 위치
  - TTL
  - 프로토콜
  - 헤더 체크섬
  - 출발지 IP 주소
  - 목적지 IP 주소
- 데이터에 IP 헤더가 붙은 것을 IP 패킷이라고 한다.

### IP 주소의 구조
- IP 주소는 인터넷 서비스 제공자(ISP)에게 받을 수 있음
- IPv4(32비트, 약 43억개), IPv6(128비트, 약 340간)
- 공인 IP 주소
  - 인터넷에 직접 연결되는 컴퓨터나 라우터에 할당한 IP
  - 라우터에만 할당
- 사설 IP 주소
  - 그 외 IP
  - 랜 안에 있는 컴퓨터는 랜의 네트워크 관리자가 자유롭게 사설 IP 주소를 할당하거나 라우터의 DHCP 기능을 사용하여 주소를 자동으로 할당
- 위 방식으로 공인 IP 주소를 절약할 수 있다.
- 사람들의 편의를 위해 8비트씩 잘라서 2진수를 10진수로 변환하여 나타냄
- IP 주소의 구조
  - 네트워크 ID: 어떤 네트워크인지
  - 호스트 ID: 해당 네트워크의 어떤 컴퓨터인지

### IP 주소의 클래스 구조
- 네트워크의 크기를 구분하는 개념

|이름|내용|이름|내용|
|:---:|:---:|:---:|:---:|
|A클래스|대규모 네트워크 주소|D클래스|멀티캐스트 주소|
|B클래스|중형 네트워크 주소|E클래스|연구 및 특수용도 주소|
|C클래스|소규모 네트워크 주소|||

- A클래스: 상위 8비트(네트워크 ID) + 하위 24비트(호스트 ID)
- B클래스: 상위 16비트(네트워크 ID) + 하위 16비트(호스트 ID)
- C클래스: 상위 24비트(네트워크 ID) + 하위 8비트(호스트 ID)
- 공인/사설 IP 주소의 범위는 별도로 지정되어 있다.

### 네트워크 주소와 브로드캐스트 주소의 구조
- 네트워크 주소: 호스트 ID가 10진수로 0
  - 전체 네트워크에서 작은 네트워크를 식별 
- 브로드캐스트 주소: 호스트 ID가 10진수로 255
  - 네트워크에 있는 컴퓨터나 장비 모두에게 한 번에 데이터를 전송하는데 사용하는 IP
- 위 두 주소는 IP 주소로 설정하면 안 된다.

### 서브넷
- 대규모 네트워크를 작은 네트워크로 분할하는 것을 서브넷팅이라고 하며, 분할된 네트워크를 서브넷이라고 한다.
- 서브넷팅을 하면 호스트 ID의 일부분이 서브넷 ID가 된다.
- 즉 네트워크 ID, 서브넷 ID, 호스트 ID로 나뉘어진다.

### 서브넷 마스크
- IP 주소를 서브넷팅하면 어디까지가 네트워크 ID고 어디부터가 호스트 ID인지 판단하기 위해 사용
- 즉, 네트워크 ID와 호스트 ID를 식별하기 위한 값
- A클래스의 서브마스크 255.0.0.0
- B클래스의 서브마스크 255.255.0.0
- C클래스의 서브마스크 255.255.255.0
- 프리픽스(prefix) 표기법
  - `/(비트 수)` 로 표시
  - 예를 들어 C클래스의 서브마스크는 /24가 된다.
- 만약 C클래스에서 서브넷팅까지 하게 되면 호스트 ID를 절반으로 쪼개 상위 4비트가 서브넷 ID, 하위 4비트를 호스트 ID로 쓴다.
  - 따라서 255.255.255.240이 된다.
  - 이를 프리픽스로 바꾸면 /28 이 된다. 기존 24비트 + 4비트(서브넷) 

## 참고 문헌
- [42seoul, net_practice](https://cdn.intra.42.fr/pdf/pdf/82257/en.subject.pdf)
- 모두의 네트워크(저자. 미즈구치 카츠야)
